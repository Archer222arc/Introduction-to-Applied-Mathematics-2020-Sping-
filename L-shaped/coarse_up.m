function u = coarse_up(u_0,n)
%把n的网格提升到2*n
N = 2*n;
u = zeros(N*(N/2-1)/2+(N-1)*(N/2-1),1);
for j = 1:n/2
    for i = 1:n/2-1
        u((N-2)*(j-1)+2*i+N/2-1) = u_0((j-1)*(n/2-1)+i);
    end
end
for j = n/2+1:n-1
    for i = 1:n-1
        u((j-n/2-1)*(2*N-2)+2*i+N-1+(N/2-1)*N/2) = u_0((j-n/2-1)*(n-1)+(n/2-1)*n/2+i);
    end
end     
v = u;
for j = 2:2:N/2
    for i = 3:2:N/2-3
        u((j-1)*(N/2-1)+i) = (u((j-1)*(N/2-1)+i+1)+u((j-1)*(N/2-1)+i-1))/2;
    end
    u((j-1)*(N/2-1)+1) = u((j-1)*(N/2-1)+2)/2;
    u((j-1)*(N/2-1)+N/2-1) = u((j-1)*(N/2-1)+N/2-2)/2;
end
d = N/2-1;
for j = 3:2:N/2-1
    for i = 3:2:N/2-3
        u((j-1)*(N/2-1)+i) = (u((j-1)*(N/2-1)+i-N/2)+u((j-1)*(N/2-1)+i+N/2)+u((j-1)*(N/2-1)+i+N/2-2)+u((j-1)*(N/2-1)+i-N/2+2))/4;
    end
    for i = 2:2:N/2-2
        u((j-1)*(N/2-1)+i) = (u((j-1)*(N/2-1)+i-N/2+1)+u((j-1)*(N/2-1)+i+N/2-1))/2;
    end
    u((j-1)*(N/2-1)+1) = (u((j-1)*(N/2-1)+3-N/2)+u((j-1)*(N/2-1)+1+N/2))/4;
    u((j-1)*(N/2-1)+N/2-1) = (u((j-1)*(N/2-1)-1)+u((j-1)*(N/2-1)+N-3))/4;
end
for i = 2:2:N/2-1
    u(i) = u(i+N/2-1)/2;
end
for i = 3:2:N/2-3
    u(i) = (u(i+N/2-2)+u(i+N/2))/2;
end
j = 1;
for i = 2:2:N/2-2
    k = (j-1)*(N/2-1)+i;
    u(k) = u(k+N/2-1)/2;
end
for i = 3:2:N/2-3
    k = (j-1)*(N/2-1)+i;
    u(k) = (u(k+N/2)+u(k+N/2-2))/4;
end
u(1) = u(N/2+1)/4;
u(N/2-1) = u(N-3)/4;
for j = N/2+2:2:N-2
    for i = 3:2:N-3
        k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;
        u((j-N/2-1)*(N-1)+i+(N/2-1)*N/2) = (u((j-N/2-1)*(N-1)+i+(N/2-1)*N/2+1)+u((j-N/2-1)*(N-1)+i+(N/2-1)*N/2-1))/2;
    end
    i = 1; k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;  u(k) = u(k+1)/2;
    i = N-1;k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2; u(k) = u(k-1)/2;
end
for j = N/2+3:2:N-3
    for i = 3:2:N-3
        k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;
        u(k) = (u(k-N)+u(k+N)+u(k-N+2)+u(k+N-2))/4;
    end
    for i = 2:2:N-2
        k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;
        u(k) = (u(k-N+1)+u(k+N-1))/2;
    end
    i = 1;  k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;    u(k) = (u(k-N+2)+u(k+N))/4;
    i = N-1;    k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;    u(k) = (u(k-N)+u(k+N-2))/4;
end

j = N-1;
for i = 2:2:N-2
    k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;
    u(k) = u(k-N+1)/2;
end
for i = 3:2:N-3
    k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;
    u(k) = (u(k-N)+u(k-N+2))/4;
end
i = 1;  k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;  u(k) = u(k-N+2)/4;
i = N-1;k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;  u(k) = u(k-N)/4;

j = N/2+1;
for i = 3:2:N/2-3
    k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;
    u(k) = (u(k+N)+u(k-N/2)+u(k-N/2+2)+u(k+N-2))/4;
end
for i = 2:2:N/2-2
    k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;
    u(k) = (u(k+N-1)+u(k-N/2+1))/2;
end
for i = N/2:2:N-2
    k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;
    u(k) = u(k+N-1)/2;
end
for i = N/2+1:2:N-3
    k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;
    u(k) = (u(k+N-2)+u(k+N))/4;
end
i = N-1;    k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2; u(k) = u(k+N-2)/4;
i = 1;  k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2;  u(k) = (u(k-N/2+2)+u(k+N))/4;
i = N/2-1;  k = (j-N/2-1)*(N-1)+i+(N/2-1)*N/2; u(k) = (u(k-N/2)+u(k+N-2)+u(k+N))/4;